<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tingrang</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<style>
  .tittel {
    font-weight: bold;
    font-size: 16pt;
  }

  .utgiver {
    color: grey;
  }


  li img {
    max-width: 50px;
    max-height: 60px;
  }

  .flex {
    display: flex;
    column-gap: 16px;
    padding: 13px 16px;
    /* margin-left: 5px; */
    margin-bottom: 5px;
    border-bottom: 1px solid grey;
  }
</style>

<body>
  <!-- <a href="rot13.html">rot13</a>
  <a href="rot13Translator.html">rot13Translator.html</a> -->
  <ol id="orderedList"></ol>

  <button onclick="flyttElement()">Flytt element</button>
</body>
<script>
  'use strict';
  const orderedList = document.getElementById('orderedList')

  fetch('spill.txt')
    .then(res => res.text())
    .then(data => {
      // console.log(data)
      // let rot13Data = rot13(data)
      let array = data.split('\n')
      // console.log(array)
      array.forEach(spill => {
        // Del opp dataen
        let spilldata = spill.split('– ')
        // console.log(spilldata)
        // print ut
        let li = document.createElement('li')
        let flexDiv = document.createElement('div')
        flexDiv.classList.add('flex')
        flexDiv.innerHTML = '<div><img src="images/' + spilldata[2] + '" alt=""></div>'
        flexDiv.innerHTML += '<div><span class="tittel">' + spilldata[0] + '</span>' + '<br>' + '<span class="utgiver">' + spilldata[1] + '</span></div>'
        li.appendChild(flexDiv)
        orderedList.appendChild(li)
      });
    })


  /**
   * formEncode() and certain parts
   * from displayVideo() are made by
   * Anders_bondehagen on
   * https://forums.fusetools.com/t/how-do-i-receive-post-data-in-php-sent-from-fuse-javascript-by-fetch/5357/3
   * This code is used to send values to PHP
   */
  // function formEncode(obj) {
  //   var str = []
  //   for (var p in obj) {
  //     str.push(encodeURIComponent(p) + "=" + encodeURIComponent(obj[p]))
  //   }
  //   return str.join("&")
  // }
  function flyttElement() {
    // Flytt elementet
    let element4 = document.querySelector('li:nth-child(4)')
    let element6 = document.querySelector('li:nth-child(6)')
    console.log(element4)
    let ol = element4.parentNode
    console.log(ol)
    ol.insertBefore(element4, element6)

    // Logg resultatet som en string? (helst det)
    // Og så sende verdien til PHP? (også helst det)
    // Mulig du må herme etter prosjekt2, og lese litt på https://forums.fusetools.com/t/how-do-……
    lagreElement()
  }

  function lagreElement() {
    $.ajax({
      url: 'updateFile.php',
      type: 'POST',
      success: function (result) {
        console.log(result); // Here, you need to use response by PHP file.
      },
      error: function () { // denne vil utløses om man bruker «go live» med «live server» plugin
        console.log('error');
      }
    });
  }


  // function rot13(str) {
  //   var input = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
  //   var output = 'NOPQRSTUVWXYZABCDEFGHIJKLMnopqrstuvwxyzabcdefghijklm';
  //   var index = x => input.indexOf(x);
  //   var translate = x => index(x) > -1 ? output[index(x)] : x;
  //   return str.split('').map(translate).join('');
  // }
</script>

</html>